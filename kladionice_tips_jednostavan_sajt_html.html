<!doctype html>
<html lang="sr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KladioniceTips — Saveti i prijavljivanje</title>
  <!-- Tailwind CDN for quick styling (production: build your own) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="Sajt sa tipovima za klađenje i sistemom prijave (demo)">
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Simple header -->
  <header class="bg-white shadow-sm sticky top-0 z-10">
    <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="#/" class="font-bold text-xl">KladioniceTips</a>
      <nav class="space-x-4">
        <a href="#/" class="text-sm">Početna</a>
        <a href="#/tips" class="text-sm">Tipovi</a>
        <a href="#/submit" class="text-sm">Pošalji tip</a>
        <a href="#/login" class="text-sm">Prijava</a>
      </nav>
    </div>
  </header>

  <main class="max-w-4xl mx-auto p-6">
    <div id="app"><!-- JS injects content here --></div>
  </main>

  <footer class="max-w-4xl mx-auto p-6 text-sm text-gray-600">
    <p>Odgovorno klađenje. Samo punoletni korisnici (18+). Ovo je demo — proverite lokalne zakone pre stvarnog poslovanja.</p>
  </footer>

  <script>
  // --- Demo single-file SPA for a betting tips site. NOT production-ready. ---
  // Features:
  // - Hash routing (#/ , #/tips, #/tips/:id, #/submit, #/login, #/admin)
  // - Tips stored in localStorage (demo). Replace with backend calls.
  // - Simple registration/login demo (localStorage). Replace with secure auth.

  // Utilities
  const qs = s => document.querySelector(s);
  const getTips = () => JSON.parse(localStorage.getItem('kt_tips') || '[]');
  const saveTips = (tips) => localStorage.setItem('kt_tips', JSON.stringify(tips));
  const getUsers = () => JSON.parse(localStorage.getItem('kt_users') || '[]');
  const saveUsers = (u) => localStorage.setItem('kt_users', JSON.stringify(u));

  // Demo seed data if empty
  if (getTips().length === 0) {
    saveTips([
      {id: 1, title: 'Tip: Dinamo - Partizan, 1X', sport: 'Fudbal', odds: '1.85', content: 'Očekujemo defanzivnu utakmicu. Manje od 2.5 gola.', author: 'Admin', date: '2025-08-10'},
      {id: 2, title: 'Tip: Zvezda, Total >2.5', sport: 'Fudbal', odds: '2.10', content: 'Napadački sastav, očekujemo više golova.', author: 'Expert', date: '2025-08-09'}
    ]);
  }

  // Router
  function router() {
    const hash = location.hash || '#/';
    const app = qs('#app');
    // route: tips detail
    if (hash.startsWith('#/tips/')) return renderTipDetail(app, hash.split('/')[2]);
    if (hash === '#/tips') return renderTipsList(app);
    if (hash === '#/submit') return renderSubmit(app);
    if (hash === '#/login') return renderLogin(app);
    if (hash === '#/admin') return renderAdmin(app);
    return renderHome(app);
  }

  // Pages
  function renderHome(app) {
    app.innerHTML = `
      <section class="bg-white p-6 rounded-lg shadow">
        <h1 class="text-2xl font-bold mb-2">Dobrodošli na KladioniceTips</h1>
        <p class="mb-4">Brzi i jasni tipovi, prijava korisnika i mogućnost slanja sopstvenih predloga. Ovo je demo — poveži sa backendom za pravu upotrebu.</p>
        <div class="flex gap-3">
          <a href="#/tips" class="px-4 py-2 bg-blue-600 text-white rounded">Pogledaj tipove</a>
          <a href="#/submit" class="px-4 py-2 border rounded">Pošalji tip</a>
        </div>
      </section>
      <section class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
        ${getTips().slice(0,4).map(t => `
            <article class="bg-white p-4 rounded shadow-sm">
              <h3 class="font-semibold">${t.title}</h3>
              <p class="text-sm text-gray-600">${t.sport} — kvota ${t.odds}</p>
              <p class="mt-2 text-sm">${t.content.slice(0,80)}...</p>
              <a href="#/tips/${t.id}" class="text-blue-600 text-sm mt-2 inline-block">Detalji</a>
            </article>
        `).join('')}
      </section>
    `;
  }

  function renderTipsList(app) {
    const tips = getTips();
    app.innerHTML = `
      <section class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-bold mb-2">Svi tipovi</h2>
        <div class="mb-4 flex gap-2">
          <select id="filterSport" class="border p-2 rounded">
            <option value="">Svi sportovi</option>
            ${[...new Set(tips.map(t=>t.sport))].map(s=>`<option>${s}</option>`).join('')}
          </select>
          <input id="search" placeholder="Pretraga..." class="border p-2 rounded flex-1" />
        </div>
        <div id="tipsList" class="grid gap-3"></div>
      </section>
    `;
    const renderList = () => {
      const sport = qs('#filterSport').value;
      const q = qs('#search').value.toLowerCase();
      const filtered = tips.filter(t=> (sport? t.sport===sport : true) && (t.title.toLowerCase().includes(q) || t.content.toLowerCase().includes(q)));
      qs('#tipsList').innerHTML = filtered.map(t=>`
        <article class="p-4 bg-gray-50 border rounded">
          <h3 class="font-semibold">${t.title}</h3>
          <p class="text-sm text-gray-600">${t.sport} — kvota ${t.odds} — <span class="text-xs">${t.date}</span></p>
          <p class="mt-2 text-sm">${t.content.slice(0,140)}...</p>
          <a href="#/tips/${t.id}" class="text-blue-600 text-sm">Detalji</a>
        </article>
      `).join('') || '<p class="text-sm text-gray-500">Nema rezultata</p>';
    }
    qs('#filterSport').addEventListener('change', renderList);
    qs('#search').addEventListener('input', renderList);
    renderList();
  }

  function renderTipDetail(app, id) {
    const tip = getTips().find(t => String(t.id) === String(id));
    if (!tip) return app.innerHTML = `<p>Tip nije pronađen.</p><a href="#/tips" class="text-blue-600">Nazad</a>`;
    app.innerHTML = `
      <article class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-bold">${tip.title}</h2>
        <p class="text-sm text-gray-600">${tip.sport} — kvota ${tip.odds} — autor: ${tip.author} — ${tip.date}</p>
        <div class="mt-4 text-sm">${tip.content}</div>
        <div class="mt-6 flex gap-3">
          <a href="#/submit?ref=${tip.id}" class="px-3 py-2 border rounded">Prijavi se</a>
          <a href="#/tips" class="px-3 py-2 text-sm text-gray-600">Nazad</a>
        </div>
      </article>
    `;
  }

  function renderSubmit(app) {
    app.innerHTML = `
      <section class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-bold mb-2">Pošalji svoj tip</h2>
        <form id="submitForm" class="space-y-3">
          <input required name="title" placeholder="Naslov" class="w-full border p-2 rounded" />
          <input required name="sport" placeholder="Sport (npr. Fudbal)" class="w-full border p-2 rounded" />
          <input name="odds" placeholder="Kvota" class="w-full border p-2 rounded" />
          <textarea name="content" required placeholder="Obrazloženje tipa" class="w-full border p-2 rounded"></textarea>
          <div class="flex gap-2">
            <input name="author" placeholder="Tvoje ime / nadimak" class="border p-2 rounded flex-1" />
            <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded">Pošalji</button>
          </div>
        </form>
        <p class="text-xs text-gray-500 mt-3">Svi prijavljeni tipovi će biti vidljivi nakon provere (u demo: automatski).</p>
      </section>
    `;
    qs('#submitForm').addEventListener('submit', e => {
      e.preventDefault();
      const fd = new FormData(e.target);
      const tip = { id: Date.now(), title: fd.get('title'), sport: fd.get('sport'), odds: fd.get('odds')||'-', content: fd.get('content'), author: fd.get('author')||'Anon', date: new Date().toISOString().slice(0,10) };
      const tips = getTips();
      tips.unshift(tip);
      saveTips(tips);
      alert('Tip poslat (demo).');
      location.hash = '#/tips';
    });
  }

  function renderLogin(app) {
    app.innerHTML = `
      <section class="bg-white p-6 rounded shadow max-w-md mx-auto">
        <h2 class="text-xl font-bold mb-2">Prijava / Registracija</h2>
        <form id="authForm" class="space-y-3">
          <input name="email" type="email" required placeholder="Email" class="w-full border p-2 rounded" />
          <input name="password" type="password" required placeholder="Lozinka" class="w-full border p-2 rounded" />
          <div class="flex gap-2">
            <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded">Prijavi se</button>
            <button id="registerBtn" type="button" class="px-4 py-2 border rounded">Registruj</button>
          </div>
        </form>
        <p class="text-xs text-gray-500 mt-3">Demo lokalna autentikacija. Ne koristite iste lozinke u stvarnom servisu.</p>
      </section>
    `;
    qs('#authForm').addEventListener('submit', e=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      const email = fd.get('email');
      const pass = fd.get('password');
      const users = getUsers();
      const user = users.find(u=>u.email===email && u.password===pass);
      if (user) {
        localStorage.setItem('kt_session', JSON.stringify({email}));
        alert('Uspesno ste prijavljeni (demo).');
        location.hash = '#/';
      } else alert('Nema naloga ili pogresna lozinka. Registrujte se.');
    });
    qs('#registerBtn').addEventListener('click', ()=>{
      const f = new FormData(qs('#authForm'));
      const email = f.get('email');
      const pass = f.get('password');
      if (!email || !pass) return alert('Popunite email i lozinku pre registracije');
      const users = getUsers();
      if (users.some(u=>u.email===email)) return alert('Korisnik vec postoji');
      users.push({email, password: pass});
      saveUsers(users);
      alert('Registrovano (demo). Sada se prijavite.');
    });
  }

  function renderAdmin(app) {
    const session = JSON.parse(localStorage.getItem('kt_session')||'null');
    if (!session || session.email !== 'admin@demo.com') return app.innerHTML = `<p>Admin dostupan samo za admin@demo.com (demo). <a href="#/login" class="text-blue-600">Prijavi se</a></p>`;
    const tips = getTips();
    app.innerHTML = `
      <section class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-bold">Admin panel</h2>
        <p class="text-sm text-gray-600">Pregled i brisanje tipova</p>
        <div class="mt-4 space-y-3">
          ${tips.map(t=>`<div class="p-3 border rounded flex justify-between items-start"><div><strong>${t.title}</strong><div class="text-xs text-gray-500">${t.sport} • ${t.date}</div></div><div><button data-id="${t.id}" class="deleteBtn px-3 py-1 border rounded">Obriši</button></div></div>`).join('')}
        </div>
      </section>
    `;
    document.querySelectorAll('.deleteBtn').forEach(b=>b.addEventListener('click', e=>{
      const id = Number(e.target.dataset.id);
      const filtered = getTips().filter(t=>t.id!==id);
      saveTips(filtered);
      alert('Obrisano (demo)');
      router();
    }));
  }

  // Init
  window.addEventListener('hashchange', router);
  router();
  </script>
</body>
</html>
